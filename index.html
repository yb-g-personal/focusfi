<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>focusfi</title>
  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="css/style.css" />
  <script>try{var s=JSON.parse(localStorage.getItem('focusfi-settings'));if(s&&s.theme)document.documentElement.dataset.theme=s.theme}catch(e){}</script>
</head>
<body>

<!-- ═══════════════════════════════════════════════
     SVG SPRITE  (inline, display:none)
     ═══════════════════════════════════════════════ -->
<svg xmlns="http://www.w3.org/2000/svg" style="display:none" aria-hidden="true">

  <symbol id="ic-play" viewBox="0 0 24 24" fill="currentColor">
    <polygon points="5 3 19 12 5 21 5 3"/>
  </symbol>

  <symbol id="ic-pause" viewBox="0 0 24 24" fill="currentColor">
    <rect x="6" y="4" width="4" height="16"/>
    <rect x="14" y="4" width="4" height="16"/>
  </symbol>

  <symbol id="ic-skip-back" viewBox="0 0 24 24" fill="currentColor">
    <polygon points="19 20 9 12 19 4 19 20"/>
    <rect x="5" y="4" width="3" height="16"/>
  </symbol>

  <symbol id="ic-skip-fwd" viewBox="0 0 24 24" fill="currentColor">
    <polygon points="5 4 15 12 5 20 5 4"/>
    <rect x="16" y="4" width="3" height="16"/>
  </symbol>

  <symbol id="ic-volume" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
    <path d="M15.54 8.46a5 5 0 0 1 0 7.07"/>
    <path d="M19.07 4.93a10 10 0 0 1 0 14.14"/>
  </symbol>

  <symbol id="ic-volume-off" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
    <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/>
    <line x1="23" y1="9" x2="17" y2="15"/>
    <line x1="17" y1="9" x2="23" y2="15"/>
  </symbol>

  <symbol id="ic-monitor" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <rect x="2" y="3" width="20" height="14" rx="2"/>
    <line x1="8" y1="21" x2="16" y2="21"/>
    <line x1="12" y1="17" x2="12" y2="21"/>
  </symbol>

  <symbol id="ic-settings" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="3"/>
    <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/>
  </symbol>

  <symbol id="ic-x" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
    <line x1="18" y1="6" x2="6" y2="18"/>
    <line x1="6" y1="6" x2="18" y2="18"/>
  </symbol>

  <symbol id="ic-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="10"/>
    <polyline points="12 6 12 12 16 14"/>
  </symbol>

  <symbol id="ic-tomato" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M12 3c-1.5 0-2.5.5-3 1.5C6 5 3 8 3 12.5 3 17.2 7 21 12 21s9-3.8 9-8.5c0-4.5-3-7.5-6-8C14.5 3.5 13.5 3 12 3z"/>
    <path d="M12 3c-1.5 0-2.5.5-3 1.5C6 5 3 8 3 12.5 3 17.2 7 21 12 21s9-3.8 9-8.5c0-4.5-3-7.5-6-8C14.5 3.5 13.5 3 12 3z"/>
    <path d="M10 2c1 1.5 1.5 2 2 2s1-.5 2-2" stroke-width="1.5"/>
  </symbol>

  <symbol id="ic-hourglass" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M5 3h14"/>
    <path d="M5 21h14"/>
    <path d="M7 3v4l5 5-5 5v4"/>
    <path d="M17 3v4l-5 5 5 5v4"/>
  </symbol>

  <symbol id="ic-eq" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
    <line x1="4" y1="21" x2="4" y2="14"/>
    <line x1="4" y1="10" x2="4" y2="3"/>
    <line x1="12" y1="21" x2="12" y2="12"/>
    <line x1="12" y1="8" x2="12" y2="3"/>
    <line x1="20" y1="21" x2="20" y2="16"/>
    <line x1="20" y1="12" x2="20" y2="3"/>
    <circle cx="4" cy="12" r="2" fill="currentColor"/>
    <circle cx="12" cy="10" r="2" fill="currentColor"/>
    <circle cx="20" cy="14" r="2" fill="currentColor"/>
  </symbol>

  <symbol id="ic-tasks" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <line x1="9" y1="6" x2="20" y2="6"/>
    <line x1="9" y1="12" x2="20" y2="12"/>
    <line x1="9" y1="18" x2="20" y2="18"/>
    <polyline points="3 6 4 7 6 5"/>
    <polyline points="3 12 4 13 6 11"/>
    <polyline points="3 18 4 19 6 17"/>
  </symbol>

  <symbol id="ic-edit" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
    <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/>
  </symbol>

  <symbol id="ic-plus" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
    <line x1="12" y1="5" x2="12" y2="19"/>
    <line x1="5" y1="12" x2="19" y2="12"/>
  </symbol>

  <symbol id="ic-help" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="12" r="10"/>
    <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
    <circle cx="12" cy="17" r="0.5" fill="currentColor"/>
  </symbol>

  <symbol id="ic-trash" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polyline points="3 6 5 6 21 6"/>
    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"/>
  </symbol>

  <symbol id="ic-music" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M9 18V5l12-2v13"/>
    <circle cx="6" cy="18" r="3"/>
    <circle cx="18" cy="16" r="3"/>
  </symbol>

  <symbol id="ic-stopwatch" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <circle cx="12" cy="13" r="8"/>
    <line x1="12" y1="9" x2="12" y2="13"/>
    <line x1="10" y1="2" x2="14" y2="2"/>
    <line x1="12" y1="2" x2="12" y2="5"/>
  </symbol>

  <symbol id="ic-wind" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M9.59 4.59A2 2 0 1 1 11 8H2"/>
    <path d="M12.59 19.41A2 2 0 1 0 14 16H2"/>
    <path d="M17.73 7.73A2.5 2.5 0 1 1 19.5 12H2"/>
  </symbol>

  <symbol id="ic-skip-ad" viewBox="0 0 24 24" fill="currentColor">
    <polygon points="5 4 15 12 5 20 5 4"/>
    <rect x="17" y="4" width="3" height="16"/>
  </symbol>

  <symbol id="ic-headphones" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M3 18v-6a9 9 0 0 1 18 0v6"/>
    <path d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3v5z"/>
    <path d="M3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3v5z"/>
  </symbol>

  <symbol id="ic-quote" viewBox="0 0 24 24" fill="currentColor">
    <path d="M6 17h3l2-4V7H5v6h3l-2 4zm8 0h3l2-4V7h-6v6h3l-2 4z"/>
  </symbol>

  <symbol id="ic-star" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
  </symbol>

  <symbol id="ic-spotify" viewBox="0 0 24 24" fill="currentColor">
    <path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/>
  </symbol>

  <symbol id="ic-more-vert" viewBox="0 0 24 24" fill="currentColor">
    <circle cx="12" cy="5" r="2"/>
    <circle cx="12" cy="12" r="2"/>
    <circle cx="12" cy="19" r="2"/>
  </symbol>

  <symbol id="ic-heart" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
    <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
  </symbol>

  <symbol id="ic-github" viewBox="0 0 24 24" fill="currentColor">
    <path d="M12 0C5.37 0 0 5.37 0 12c0 5.31 3.435 9.795 8.205 11.385.6.105.825-.255.825-.57 0-.285-.015-1.23-.015-2.235-3.015.555-3.795-.735-4.035-1.41-.135-.345-.72-1.41-1.23-1.695-.42-.225-1.02-.78-.015-.795.945-.015 1.62.87 1.845 1.23 1.08 1.815 2.805 1.305 3.495.99.105-.78.42-1.305.765-1.605-2.67-.3-5.46-1.335-5.46-5.925 0-1.305.465-2.385 1.23-3.225-.12-.3-.54-1.53.12-3.18 0 0 1.005-.315 3.3 1.23.96-.27 1.98-.405 3-.405s2.04.135 3 .405c2.295-1.56 3.3-1.23 3.3-1.23.66 1.65.24 2.88.12 3.18.765.84 1.23 1.905 1.23 3.225 0 4.605-2.805 5.625-5.475 5.925.435.375.81 1.095.81 2.22 0 1.605-.015 2.895-.015 3.3 0 .315.225.69.825.57A12.02 12.02 0 0 0 24 12c0-6.63-5.37-12-12-12z"/>
  </symbol>

  <!-- Copilot sparkle logo -->
  <symbol id="ic-copilot" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
    <path d="M12 2l2.09 6.26L20.18 10l-6.09 1.74L12 18l-2.09-6.26L3.82 10l6.09-1.74L12 2z"/>
    <path d="M5 3l.7 2.1L7.8 5.8l-2.1.7L5 8.6l-.7-2.1L2.2 5.8l2.1-.7L5 3z" opacity=".55"/>
    <path d="M19 16l.5 1.5 1.5.5-1.5.5-.5 1.5-.5-1.5L17 18l1.5-.5.5-1.5z" opacity=".55"/>
  </symbol>

</svg>

<!-- ═══════════════════════════════════════════════
     BACKGROUND LAYERS
     ═══════════════════════════════════════════════ -->
<div id="background">
  <div id="bg-gradient" class="bg-layer active"></div>
  <!-- Large clock overlay shown on gradient/clock mode -->
  <div id="big-clock" class="big-clock">
    <div class="big-clock-time">
      <span id="big-clock-hours">12</span><span class="big-clock-sep">:</span><span id="big-clock-minutes">00</span><span class="big-clock-seconds" id="big-clock-seconds">00</span><span class="big-clock-ampm" id="big-clock-ampm">AM</span>
    </div>
    <div class="big-clock-date" id="big-clock-date">Saturday, January 1, 2026</div>
    <!-- Pomodoro timer fades in here when running -->
    <div id="big-clock-pomo" class="big-clock-pomo hidden">
      <svg class="pomo-icon"><use href="#ic-tomato"/></svg>
      <span id="big-clock-pomo-time">25:00</span>
      <span class="pomo-sep">·</span>
      <span id="big-clock-pomo-end">ends at --:--</span>
    </div>
  </div>
  <div id="bg-gif" class="bg-layer">
    <video id="bg-video" muted playsinline loop></video>
  </div>
</div>

<!-- ═══════════════════════════════════════════════
     YOUTUBE PLAYER WRAPPER
     Classes applied by JS:
       .mode-audio  → 1 px off-screen, audio only
       .mode-bg     → fullscreen background
       .mode-modal  → centred foreground modal
     ═══════════════════════════════════════════════ -->
<div id="yt-wrapper" class="mode-audio">
  <div id="yt-player"></div>
  <!-- transparent cover that blocks accidental YouTube UI clicks -->
  <div id="yt-cover"></div>
</div>

<!-- Spotify embed player (floating, toggled when Spotify is the active source) -->
<div id="spotify-wrapper" class="hidden">
  <div id="spotify-embed"></div>
</div>

<!-- Modal dark overlay (shown with foreground video) -->
<div id="modal-overlay" class="hidden">
  <button id="modal-close" aria-label="Close video">
    <svg class="icon"><use href="#ic-x"/></svg>
  </button>
</div>

<!-- ═══════════════════════════════════════════════
     HEADER
     ═══════════════════════════════════════════════ -->
<header id="header">

  <div class="header-left">
    <svg class="logo-svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <circle cx="12" cy="12" r="10"/>
      <line class="logo-hand-min" x1="12" y1="12" x2="12" y2="6"/>
      <line class="logo-hand-hr" x1="12" y1="12" x2="16" y2="14"/>
    </svg>
    <span class="logo-text">focusfi</span>
  </div>

  <div class="header-center">
    <div id="running-tools-bar" class="running-tools-bar"></div>
  </div>

  <div class="header-right">
    <span id="clock" class="clock" aria-live="off"></span>
    <div class="tools-dropdown" id="tools-dropdown">
      <button class="tool-toggle tools-trigger" id="tools-trigger" aria-label="Toggle tools menu" aria-expanded="false">
        <svg class="icon"><use href="#ic-star"/></svg>
        <span class="tl">Tools</span>
      </button>
      <div class="tools-menu hidden" id="tools-menu">
        <button class="tools-menu-item" data-panel="timer-panel">
          <svg class="icon"><use href="#ic-tomato"/></svg>
          <span>Pomodoro</span>
        </button>
        <button class="tools-menu-item" data-panel="tasks-panel">
          <svg class="icon"><use href="#ic-tasks"/></svg>
          <span>Tasks</span>
        </button>
        <button class="tools-menu-item" data-panel="notes-panel">
          <svg class="icon"><use href="#ic-edit"/></svg>
          <span>Notes</span>
        </button>
        <button class="tools-menu-item" data-panel="stopwatch-panel">
          <svg class="icon"><use href="#ic-stopwatch"/></svg>
          <span>Stopwatch</span>
        </button>
        <button class="tools-menu-item" data-panel="countdown-panel">
          <svg class="icon"><use href="#ic-hourglass"/></svg>
          <span>Timer</span>
        </button>
        <button class="tools-menu-item" data-panel="breathing-panel">
          <svg class="icon"><use href="#ic-wind"/></svg>
          <span>Breathe</span>
        </button>
        <button class="tools-menu-item" data-panel="ambient-panel">
          <svg class="icon"><use href="#ic-headphones"/></svg>
          <span>Ambient</span>
        </button>
        <button class="tools-menu-item" data-panel="quote-panel">
          <svg class="icon"><use href="#ic-quote"/></svg>
          <span>Quote</span>
        </button>
      </div>
    </div>
    <button class="tool-toggle" data-panel="settings-panel" aria-label="Toggle settings">
      <svg class="icon"><use href="#ic-settings"/></svg>
      <span class="tl">Settings</span>
    </button>
  </div>

</header>

<!-- ═══════════════════════════════════════════════
     TOOL PANELS  (right side)
     ═══════════════════════════════════════════════ -->
<aside id="tools-container" aria-label="Study tools">

  <!-- ── Timer ── -->
  <div id="timer-panel" class="panel hidden" role="region" aria-label="Focus Timer">
    <div class="panel-header">
      <h3>Focus Timer</h3>
      <div class="panel-actions">
        <button class="help-btn" aria-label="About Focus Timer"
          data-tip="Pomodoro timer: work in timed sessions separated by short breaks. Music pauses automatically when your session ends.">
          <svg class="icon icon-sm"><use href="#ic-help"/></svg>
        </button>
        <button class="close-panel" data-panel="timer-panel" aria-label="Close">
          <svg class="icon icon-sm"><use href="#ic-x"/></svg>
        </button>
      </div>
    </div>
    <div class="panel-body">
      <div class="mode-tabs" role="tablist" aria-label="Timer mode">
        <button class="mode-tab active" data-mode="focus" role="tab" aria-selected="true">Focus</button>
        <button class="mode-tab" data-mode="short" role="tab" aria-selected="false">Short Break</button>
        <button class="mode-tab" data-mode="long" role="tab" aria-selected="false">Long Break</button>
      </div>
      <div class="timer-display" aria-live="polite">
        <span id="timer-time">25:00</span>
      </div>
      <div class="timer-meta">
        <span id="session-dots" aria-hidden="true">○○○○</span>
        <span id="session-label">Session 1 of 4</span>
      </div>
      <div class="timer-controls">
        <button id="btn-timer-start" class="btn-primary">Start</button>
        <button id="btn-timer-reset" class="btn-secondary">Reset</button>
      </div>
      <div class="timer-settings">
        <label>Focus <input type="number" id="inp-focus" value="25" min="1" max="99"> min</label>
        <label>Break <input type="number" id="inp-break" value="5" min="1" max="30"> min</label>
      </div>
    </div>
  </div>

  <!-- ── Tasks ── -->
  <div id="tasks-panel" class="panel hidden" role="region" aria-label="Tasks">
    <div class="panel-header">
      <h3>Tasks</h3>
      <div class="panel-actions">
        <button class="help-btn" aria-label="About Tasks"
          data-tip="Keep a lightweight to-do list for your session. Tasks are saved automatically in your browser.">
          <svg class="icon icon-sm"><use href="#ic-help"/></svg>
        </button>
        <button class="close-panel" data-panel="tasks-panel" aria-label="Close">
          <svg class="icon icon-sm"><use href="#ic-x"/></svg>
        </button>
      </div>
    </div>
    <div class="panel-body">
      <p id="tasks-progress" class="tasks-progress">No tasks yet</p>
      <div id="task-list" role="list"></div>
      <div class="task-add-row">
        <input type="text" id="new-task-input" placeholder="Add a task…" maxlength="120" autocomplete="off" aria-label="New task" />
        <button id="btn-add-task" aria-label="Add task">
          <svg class="icon icon-sm"><use href="#ic-plus"/></svg>
        </button>
      </div>
    </div>
  </div>

  <!-- ── Notes ── -->
  <div id="notes-panel" class="panel hidden" role="region" aria-label="Notes">
    <div class="panel-header">
      <h3>Notes</h3>
      <div class="panel-actions">
        <button class="help-btn" aria-label="About Notes"
          data-tip="Quick scratch pad for formulas, vocabulary, or ideas. Auto-saved in your browser between sessions.">
          <svg class="icon icon-sm"><use href="#ic-help"/></svg>
        </button>
        <button class="close-panel" data-panel="notes-panel" aria-label="Close">
          <svg class="icon icon-sm"><use href="#ic-x"/></svg>
        </button>
      </div>
    </div>
    <div class="panel-body">
      <textarea id="notes-area" placeholder="Start typing…" spellcheck="true" aria-label="Notes"></textarea>
      <div class="notes-footer">
        <span id="notes-count">0 words</span>
        <button id="btn-notes-clear" class="btn-ghost">Clear</button>
      </div>
    </div>
  </div>

  <!-- ── Stopwatch ── -->
  <div id="stopwatch-panel" class="panel hidden" role="region" aria-label="Stopwatch">
    <div class="panel-header">
      <h3>Stopwatch</h3>
      <div class="panel-actions">
        <button class="help-btn" aria-label="About Stopwatch"
          data-tip="A simple stopwatch to track how long you spend on tasks. Start, stop, and reset as needed.">
          <svg class="icon icon-sm"><use href="#ic-help"/></svg>
        </button>
        <button class="close-panel" data-panel="stopwatch-panel" aria-label="Close">
          <svg class="icon icon-sm"><use href="#ic-x"/></svg>
        </button>
      </div>
    </div>
    <div class="panel-body">
      <div class="timer-display">
        <span id="stopwatch-time">00:00:00</span>
      </div>
      <div class="timer-controls">
        <button id="btn-stopwatch-start" class="btn-primary">Start</button>
        <button id="btn-stopwatch-reset" class="btn-secondary">Reset</button>
      </div>
      <div id="stopwatch-laps" class="stopwatch-laps"></div>
      <button id="btn-stopwatch-lap" class="btn-secondary" style="width:100%;margin-top:8px" disabled>Lap</button>
    </div>
  </div>

  <!-- ── Breathing Exercise ── -->
  <div id="breathing-panel" class="panel hidden" role="region" aria-label="Breathing Exercise">
    <div class="panel-header">
      <h3>Breathe</h3>
      <div class="panel-actions">
        <button class="help-btn" aria-label="About Breathing"
          data-tip="4-7-8 breathing technique: Inhale 4s, Hold 7s, Exhale 8s. Reduces stress and improves focus.">
          <svg class="icon icon-sm"><use href="#ic-help"/></svg>
        </button>
        <button class="close-panel" data-panel="breathing-panel" aria-label="Close">
          <svg class="icon icon-sm"><use href="#ic-x"/></svg>
        </button>
      </div>
    </div>
    <div class="panel-body breathing-body">
      <div class="breathing-circle" id="breathing-circle">
        <span class="breathing-label" id="breathing-label">Ready</span>
      </div>
      <div class="timer-controls" style="margin-top:14px">
        <button id="btn-breathing-start" class="btn-primary">Start</button>
        <button id="btn-breathing-stop" class="btn-secondary">Stop</button>
      </div>
      <p class="breathing-info">4-7-8 technique · Inhale · Hold · Exhale</p>
    </div>
  </div>

  <!-- ── Countdown Timer ── -->
  <div id="countdown-panel" class="panel hidden" role="region" aria-label="Countdown Timer">
    <div class="panel-header">
      <h3>Timer</h3>
      <div class="panel-actions">
        <button class="help-btn" aria-label="About Timer"
          data-tip="A generic countdown timer. Set any duration and start. Get notified when time is up.">
          <svg class="icon icon-sm"><use href="#ic-help"/></svg>
        </button>
        <button class="close-panel" data-panel="countdown-panel" aria-label="Close">
          <svg class="icon icon-sm"><use href="#ic-x"/></svg>
        </button>
      </div>
    </div>
    <div class="panel-body">
      <div class="timer-display" aria-live="polite">
        <span id="countdown-time">00:00</span>
      </div>
      <div class="countdown-set-row">
        <label>Min <input type="number" id="inp-countdown-min" value="5" min="0" max="999"></label>
        <label>Sec <input type="number" id="inp-countdown-sec" value="0" min="0" max="59"></label>
      </div>
      <div class="timer-controls">
        <button id="btn-countdown-start" class="btn-primary">Start</button>
        <button id="btn-countdown-reset" class="btn-secondary">Reset</button>
      </div>
    </div>
  </div>

  <!-- ── Ambient Sounds ── -->
  <div id="ambient-panel" class="panel hidden" role="region" aria-label="Ambient Sounds">
    <div class="panel-header">
      <h3>Ambient Sounds</h3>
      <div class="panel-actions">
        <button class="help-btn" aria-label="About Ambient Sounds"
          data-tip="Layer calming ambient sounds on top of your music. Mix rain, fireplace, birds, or wind to create your ideal focus environment.">
          <svg class="icon icon-sm"><use href="#ic-help"/></svg>
        </button>
        <button class="close-panel" data-panel="ambient-panel" aria-label="Close">
          <svg class="icon icon-sm"><use href="#ic-x"/></svg>
        </button>
      </div>
    </div>
    <div class="panel-body">
      <div class="ambient-grid" id="ambient-grid"></div>
      <div class="ambient-master">
        <label>Master volume</label>
        <input type="range" id="ambient-volume" min="0" max="100" value="50" aria-label="Ambient volume">
      </div>
    </div>
  </div>

  <!-- ── Focus Quote ── -->
  <div id="quote-panel" class="panel hidden" role="region" aria-label="Focus Quote">
    <div class="panel-header">
      <h3>Focus Quote</h3>
      <div class="panel-actions">
        <button class="help-btn" aria-label="About Focus Quote"
          data-tip="Get inspired with a random focus and productivity quote. Click the refresh button for a new one.">
          <svg class="icon icon-sm"><use href="#ic-help"/></svg>
        </button>
        <button class="close-panel" data-panel="quote-panel" aria-label="Close">
          <svg class="icon icon-sm"><use href="#ic-x"/></svg>
        </button>
      </div>
    </div>
    <div class="panel-body">
      <blockquote class="focus-quote" id="focus-quote-text">
        The secret of getting ahead is getting started.
      </blockquote>
      <p class="focus-quote-author" id="focus-quote-author">— Mark Twain</p>
      <button id="btn-new-quote" class="btn-secondary" style="width:100%;margin-top:10px">New Quote</button>
    </div>
  </div>

  <!-- ── Settings ── -->
  <div id="settings-panel" class="panel hidden" role="region" aria-label="Settings">
    <div class="panel-header">
      <h3>Settings</h3>
      <div class="panel-actions">
        <button class="help-btn" aria-label="About Settings"
          data-tip="Customize your focusfi experience — choose scenes, music source, themes, clock format, and display preferences.">
          <svg class="icon icon-sm"><use href="#ic-help"/></svg>
        </button>
        <button class="close-panel" data-panel="settings-panel" aria-label="Close">
          <svg class="icon icon-sm"><use href="#ic-x"/></svg>
        </button>
      </div>
    </div>
    <div class="panel-body">
      <p class="section-label">Scene <button class="setting-help" data-tip="Choose your background: Clock shows a large centered clock, Video cycles MP4 backgrounds, Stream uses the YouTube video as the background.">?</button></p>
      <div class="bg-selector" role="group" aria-label="Background mode">
        <button class="bg-btn active" data-bg="gradient">Clock</button>
        <button class="bg-btn" data-bg="gif">Video</button>
        <button class="bg-btn" data-bg="stream">Stream</button>
      </div>

      <!-- Video background controls -->
      <div id="video-bg-controls" class="video-bg-controls hidden">
        <div class="vid-mode-selector" role="group" aria-label="Video playback mode">
          <button class="vid-mode-btn active" data-vidmode="loop">
            <svg class="icon icon-sm" style="margin-right:4px"><use href="#ic-play"/></svg>Loop
          </button>
          <button class="vid-mode-btn" data-vidmode="shuffle">
            <svg class="icon icon-sm" style="margin-right:4px"><use href="#ic-eq"/></svg>Shuffle
          </button>
        </div>
        <div class="vid-nav-row">
          <button id="btn-prev-video" class="btn-secondary btn-sm" aria-label="Previous video">
            <svg class="icon icon-sm"><use href="#ic-skip-back"/></svg>
          </button>
          <span id="video-name" class="vid-current-name">No videos</span>
          <button id="btn-next-video" class="btn-secondary btn-sm" aria-label="Next video">
            <svg class="icon icon-sm"><use href="#ic-skip-fwd"/></svg>
          </button>
        </div>
      </div>

      <p class="section-label" style="margin-top:16px">Music Source <button class="setting-help" data-tip="Switch between YouTube livestreams and Spotify playlists as your music source.">?</button></p>
      <div class="source-selector" role="group" aria-label="Music source">
        <button class="source-btn active" data-source="youtube">YouTube</button>
        <button class="source-btn" data-source="spotify">Spotify</button>
      </div>

      <!-- Spotify playlist picker (shown when Spotify is selected) -->
      <div id="spotify-section" class="spotify-section hidden">
        <p class="spotify-hint">
          <svg class="icon icon-sm spotify-green" style="vertical-align:-2px;margin-right:3px"><use href="#ic-spotify"/></svg>
          Pick a playlist — plays in the embedded Spotify player. Log into Spotify in your browser for full tracks.
        </p>
        <div id="spotify-presets-grid" class="spotify-presets-grid"></div>
        <div class="spotify-custom-row">
          <input type="text" id="spotify-custom-url" placeholder="Paste Spotify playlist/album URL…" autocomplete="off" aria-label="Spotify URL"/>
          <button id="btn-spotify-load" class="btn-primary btn-sm">Load</button>
        </div>
      </div>

      <p class="section-label" style="margin-top:16px">Appearance <button class="setting-help" data-tip="Choose a color theme. Auto switches between light, evening, and dark based on the time of day.">?</button></p>
      <div class="theme-selector" role="group" aria-label="Theme">
        <button class="theme-btn" data-theme="auto">Auto</button>
        <button class="theme-btn active" data-theme="dark">Dark</button>
        <button class="theme-btn" data-theme="light">Light</button>
        <button class="theme-btn" data-theme="evening">Evening</button>
      </div>

      <p class="section-label" style="margin-top:16px">Clock Format <button class="setting-help" data-tip="System uses your device's locale preference. Choose 12-hour or 24-hour to override.">?</button></p>
      <div class="clock-fmt-selector" role="group" aria-label="Clock format">
        <button class="clock-fmt-btn active" data-fmt="system">System</button>
        <button class="clock-fmt-btn" data-fmt="12h">12-hour</button>
        <button class="clock-fmt-btn" data-fmt="24h">24-hour</button>
      </div>

      <p class="section-label" style="margin-top:16px">Display <button class="setting-help" data-tip="Toggle various display elements and behavior options.">?</button></p>
      <div class="settings-toggles">
        <label class="setting-toggle-row">
          <span>Show seconds on clock <button class="setting-help" data-tip="Show seconds alongside the hours and minutes on the clock.">?</button></span>
          <input type="checkbox" id="setting-show-seconds" class="setting-checkbox">
        </label>
        <label class="setting-toggle-row">
          <span>Show date on clock <button class="setting-help" data-tip="Display the full date beneath the big clock on the gradient scene.">?</button></span>
          <input type="checkbox" id="setting-show-date" class="setting-checkbox" checked>
        </label>
        <label class="setting-toggle-row">
          <span>Show briefs <button class="setting-help" data-tip="Show live mini-status chips in the header for running tools like timers, breathing, and ambient sounds.">?</button></span>
          <input type="checkbox" id="setting-show-briefs" class="setting-checkbox" checked>
        </label>
        <label class="setting-toggle-row">
          <span>Notification sounds <button class="setting-help" data-tip="Play audio alerts when timers end. Disable for silent operation.">?</button></span>
          <input type="checkbox" id="setting-notif-sounds" class="setting-checkbox" checked>
        </label>
        <label class="setting-toggle-row">
          <span>Auto-resume after break <button class="setting-help" data-tip="Automatically resume music when a Pomodoro break ends.">?</button></span>
          <input type="checkbox" id="setting-auto-resume" class="setting-checkbox" checked>
        </label>
        <label class="setting-toggle-row">
          <span>Show focus quote on start <button class="setting-help" data-tip="Open the focus quote panel automatically when focusfi loads.">?</button></span>
          <input type="checkbox" id="setting-show-quote" class="setting-checkbox">
        </label>
      </div>

      <div class="settings-credits">
        <button id="btn-credits" class="btn-credits">
          <svg class="icon icon-sm"><use href="#ic-heart"/></svg>
          Credits
        </button>
      </div>
    </div>
  </div>

</aside>

<!-- ═══════════════════════════════════════════════
     CREDITS DIALOG
     ═══════════════════════════════════════════════ -->
<div id="credits-dialog" class="dialog-backdrop hidden" role="dialog" aria-modal="true" aria-label="Credits">
  <div class="dialog">
    <div class="dialog-header">
      <h3>Credits</h3>
      <button id="btn-credits-close" aria-label="Close">
        <svg class="icon"><use href="#ic-x"/></svg>
      </button>
    </div>
    <div class="dialog-body credits-body">
      <div class="credits-section">
        <p class="credits-title">Made by</p>
        <p class="credits-name">Vaibhav Gannavarapu</p>
        <a href="https://github.com/yb-g" target="_blank" rel="noopener" class="credits-link">
          <svg class="icon icon-sm"><use href="#ic-github"/></svg> github.com/yb-g
        </a>
      </div>
      <div class="credits-section">
        <p class="credits-title">Built with</p>
        <p class="credits-name">
          <svg class="icon icon-sm" style="vertical-align:-2px;margin-right:4px;color:var(--accent)"><use href="#ic-copilot"/></svg>GitHub Copilot
        </p>
        <p class="credits-detail">AI pair-programming assistant by GitHub</p>
      </div>
      <div class="credits-section">
        <p class="credits-title">Repository</p>
        <a href="https://github.com/yb-g-personal/focusfi" target="_blank" rel="noopener" class="credits-link">
          <svg class="icon icon-sm"><use href="#ic-github"/></svg> yb-g-personal/focusfi
        </a>
      </div>
      <div class="credits-section">
        <p class="credits-title">Assets</p>
        <p class="credits-detail">Ambient sounds from <a href="https://pixabay.com/" target="_blank" rel="noopener">Pixabay</a></p>
        <p class="credits-detail">Background videos from <a href="https://moewalls.com/" target="_blank" rel="noopener">MoeWalls</a></p>
      </div>
    </div>
  </div>
</div>

<!-- ═══════════════════════════════════════════════
     STREAM SETTINGS DIALOG
     ═══════════════════════════════════════════════ -->
<div id="stream-dialog" class="dialog-backdrop hidden" role="dialog" aria-modal="true" aria-label="Stream settings">
  <div class="dialog">
    <div class="dialog-header">
      <h3>Stream Settings</h3>
      <button id="btn-dialog-close" aria-label="Close dialog">
        <svg class="icon"><use href="#ic-x"/></svg>
      </button>
    </div>
    <div class="dialog-body">
      <p class="section-label">Preset streams <button class="setting-help" data-tip="Select from curated lofi livestreams. When Spotify is active, these show Spotify playlists instead.">?</button></p>
      <div id="stream-presets"></div>

      <p class="section-label" style="margin-top:20px">Custom stream <button class="setting-help" data-tip="Paste any YouTube URL or video ID to add it as a custom stream you can control with focusfi's player.">?</button></p>
      <p class="dialog-hint">Paste a YouTube URL or video ID to play your own stream with the same controls:</p>
      <div class="input-row">
        <input type="text" id="custom-url-input"
          placeholder="https://www.youtube.com/watch?v=…"
          autocomplete="off" aria-label="YouTube URL" />
        <button id="btn-load-stream" class="btn-primary">Load</button>
      </div>
      <p id="stream-error" class="error-msg hidden" role="alert"></p>
    </div>
  </div>
</div>

<!-- ═══════════════════════════════════════════════
     SKIP AD OVERLAY
     ═══════════════════════════════════════════════ -->
<div id="skip-ad-overlay" class="skip-ad-overlay hidden">
  <button id="btn-skip-ad" class="btn-skip-ad" aria-label="Skip ad">
    <svg class="icon" style="width:18px;height:18px"><use href="#ic-skip-ad"/></svg>
    <span>Skip Ad</span>
  </button>
</div>

<!-- ═══════════════════════════════════════════════
     PLAYER BAR  (bottom)
     ═══════════════════════════════════════════════ -->
<div id="player-bar" role="region" aria-label="Player controls">

  <div class="player-stream-info">
    <svg class="icon player-icon"><use href="#ic-music"/></svg>
    <div class="stream-meta">
      <span id="stream-name">Lofi Girl</span>
      <span id="stream-status">Loading…</span>
    </div>
  </div>

  <div class="player-center">
    <button id="btn-prev" aria-label="Previous stream" title="Previous stream (←)">
      <svg class="icon"><use href="#ic-skip-back"/></svg>
    </button>
    <button id="btn-play-pause" class="btn-play" aria-label="Play / Pause" title="Play / Pause (Space)">
      <svg class="icon"><use href="#ic-play"/></svg>
    </button>
    <button id="btn-next" aria-label="Next stream" title="Next stream (→)">
      <svg class="icon"><use href="#ic-skip-fwd"/></svg>
    </button>
  </div>

  <div class="player-right">
    <button id="btn-mute" aria-label="Unmute" title="Mute / Unmute (M)">
      <svg class="icon"><use href="#ic-volume-off"/></svg>
    </button>
    <input type="range" id="volume-slider" min="0" max="100" value="50"
      aria-label="Volume" title="Volume" />
    <button id="btn-view" aria-label="Watch in foreground" title="Watch in foreground (F)">
      <svg class="icon"><use href="#ic-monitor"/></svg>
    </button>
    <button id="btn-stream-settings" aria-label="Stream settings" title="Stream settings">
      <svg class="icon"><use href="#ic-more-vert"/></svg>
    </button>
  </div>

</div>

<!-- ═══════════════════════════════════════════════
     SCRIPTS
     onYouTubeIframeAPIReady must be global and set
     before the YT API script fires its callback.
     ═══════════════════════════════════════════════ -->
<script>
  window._ytApiReady = false;
  window.onYouTubeIframeAPIReady = function () {
    window._ytApiReady = true;
    window.dispatchEvent(new CustomEvent('yt-ready'));
  };
  // Spotify IFrame API — official callback pattern
  window.onSpotifyIframeApiReady = function (IFrameAPI) {
    window._spotifyIFrameAPI = IFrameAPI;
    window.dispatchEvent(new CustomEvent('spotify-iframe-ready'));
  };
</script>
<script src="https://www.youtube.com/iframe_api"></script>
<script src="https://open.spotify.com/embed/iframe-api/v1" async></script>
<script type="module" src="js/app.js"></script>

<!-- ═══════════════════════════════════════════════
     ALARM OVERLAY (shown when timer/pomodoro ends)
     ═══════════════════════════════════════════════ -->
<div id="alarm-overlay" class="alarm-overlay hidden" role="alertdialog" aria-modal="true" aria-label="Timer alarm">
  <div class="alarm-content">
    <div class="alarm-ring">
      <svg class="alarm-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/>
        <path d="M13.73 21a2 2 0 0 1-3.46 0"/>
      </svg>
    </div>
    <p id="alarm-message" class="alarm-message">Time's up!</p>
    <button id="btn-alarm-stop" class="btn-alarm-stop">Stop</button>
  </div>
</div>

<!-- ═══════════════════════════════════════════════
     LOADING SCREEN
     ═══════════════════════════════════════════════ -->
<!-- Zen mode exit bar (appears on mouse move / tap while in zen mode) -->
<div id="zen-exit-bar" class="zen-exit-bar hidden">
  <button id="btn-zen-exit">Exit Zen Mode</button>
</div>

<div id="loader" class="loader" aria-hidden="true">
  <div class="loader-content">
    <svg class="loader-clock" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="12" cy="12" r="10"/>
      <polyline class="loader-hands" points="12 6 12 12 16 14"/>
    </svg>
    <span class="loader-text">focusfi</span>
  </div>
  <button id="loader-enter" class="loader-enter">click to enter</button>
</div>

</body>
</html>
